2026-01-31 03:35:25 [INFO] Question: "Which company carries the heaviest Cargo Weight?"
2026-01-31 03:35:25 [INFO] Running PandasAI with litellm LLM...
2026-01-31 03:35:25 [INFO] Prompt ID: 5ea22bc7-86e3-4eba-95a4-ae10c3dd1526
2026-01-31 03:35:25 [INFO] Generating new code...
2026-01-31 03:35:26 [INFO] Using Prompt: <tables>

<table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


</tables>

The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>



Update this initial code:
```python
# TODO: import the required dependencies
import pandas as pd

# Write code here

# Declare result var: 
type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }

```



### QUERY
 "Which company carries the heaviest Cargo Weight?"

At the end, declare "result" variable as a dictionary of type and value in the following format:

type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }



Generate python code and return full updated code:

### Note: Use only relevant table for query and do aggregation, sorting, joins and grouby through sql query
2026-01-31 03:35:35 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}
2026-01-31 03:35:35 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

2026-01-31 03:35:35 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

2026-01-31 03:35:35 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 "Which company carries the heaviest Cargo Weight?"

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:35:37 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}
2026-01-31 03:35:37 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

2026-01-31 03:35:37 [INFO] Retrying Code Generation (1/3)...
2026-01-31 03:35:37 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

2026-01-31 03:35:37 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 "Which company carries the heaviest Cargo Weight?"

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:35:37 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}
2026-01-31 03:35:37 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

2026-01-31 03:35:37 [INFO] Retrying Code Generation (2/3)...
2026-01-31 03:35:37 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

2026-01-31 03:35:37 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 "Which company carries the heaviest Cargo Weight?"

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:35:37 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}
2026-01-31 03:35:37 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

2026-01-31 03:35:37 [INFO] Retrying Code Generation (3/3)...
2026-01-31 03:35:37 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

2026-01-31 03:35:37 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 "Which company carries the heaviest Cargo Weight?"

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:35:37 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}
2026-01-31 03:35:37 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}

2026-01-31 03:35:37 [INFO] Maximum retry attempts exceeded. Last error: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5' not found"}
2026-01-31 03:42:28 [INFO] Question: "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"
2026-01-31 03:42:28 [INFO] Running PandasAI with litellm LLM...
2026-01-31 03:42:28 [INFO] Prompt ID: 389686b7-9bae-4d7e-bc55-55230d8d5808
2026-01-31 03:42:28 [INFO] Generating new code...
2026-01-31 03:42:28 [INFO] Using Prompt: <tables>

<table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


</tables>

The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>



Update this initial code:
```python
# TODO: import the required dependencies
import pandas as pd

# Write code here

# Declare result var: 
type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }

```



### QUERY
 "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"

At the end, declare "result" variable as a dictionary of type and value in the following format:

type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }



Generate python code and return full updated code:

### Note: Use only relevant table for query and do aggregation, sorting, joins and grouby through sql query
2026-01-31 03:43:10 [INFO] Question: "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"
2026-01-31 03:43:10 [INFO] Running PandasAI with litellm LLM...
2026-01-31 03:43:10 [INFO] Prompt ID: 8e190fd7-e3d0-4361-82c0-f0a81ca9037c
2026-01-31 03:43:10 [INFO] Generating new code...
2026-01-31 03:43:10 [INFO] Using Prompt: <tables>

<table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


</tables>

The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>



Update this initial code:
```python
# TODO: import the required dependencies
import pandas as pd

# Write code here

# Declare result var: 
type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }

```



### QUERY
 "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"

At the end, declare "result" variable as a dictionary of type and value in the following format:

type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }



Generate python code and return full updated code:

### Note: Use only relevant table for query and do aggregation, sorting, joins and grouby through sql query
2026-01-31 03:43:11 [INFO] Question: "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"
2026-01-31 03:43:11 [INFO] Running PandasAI with litellm LLM...
2026-01-31 03:43:11 [INFO] Prompt ID: 53654b1f-ba6b-42ae-831e-f9ad1c0852a3
2026-01-31 03:43:11 [INFO] Generating new code...
2026-01-31 03:43:11 [INFO] Using Prompt: <tables>

<table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


</tables>

The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>



Update this initial code:
```python
# TODO: import the required dependencies
import pandas as pd

# Write code here

# Declare result var: 
type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }

```



### QUERY
 "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"

At the end, declare "result" variable as a dictionary of type and value in the following format:

type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }



Generate python code and return full updated code:

### Note: Use only relevant table for query and do aggregation, sorting, joins and grouby through sql query
2026-01-31 03:43:12 [INFO] Question: "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"
2026-01-31 03:43:12 [INFO] Running PandasAI with litellm LLM...
2026-01-31 03:43:12 [INFO] Prompt ID: 89fa4cc4-2424-4af9-8179-abfd49e00696
2026-01-31 03:43:12 [INFO] Generating new code...
2026-01-31 03:43:12 [INFO] Using Prompt: <tables>

<table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


</tables>

The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>



Update this initial code:
```python
# TODO: import the required dependencies
import pandas as pd

# Write code here

# Declare result var: 
type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }

```



### QUERY
 "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"

At the end, declare "result" variable as a dictionary of type and value in the following format:

type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }



Generate python code and return full updated code:

### Note: Use only relevant table for query and do aggregation, sorting, joins and grouby through sql query
2026-01-31 03:43:13 [INFO] Question: "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"
2026-01-31 03:43:13 [INFO] Running PandasAI with litellm LLM...
2026-01-31 03:43:13 [INFO] Prompt ID: cd7d4976-8f36-4329-9091-7a40ca20ad18
2026-01-31 03:43:13 [INFO] Generating new code...
2026-01-31 03:43:13 [INFO] Using Prompt: <tables>

<table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


</tables>

The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>



Update this initial code:
```python
# TODO: import the required dependencies
import pandas as pd

# Write code here

# Declare result var: 
type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }

```



### QUERY
 "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"

At the end, declare "result" variable as a dictionary of type and value in the following format:

type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }



Generate python code and return full updated code:

### Note: Use only relevant table for query and do aggregation, sorting, joins and grouby through sql query
2026-01-31 03:43:14 [INFO] Question: "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"
2026-01-31 03:43:14 [INFO] Running PandasAI with litellm LLM...
2026-01-31 03:43:14 [INFO] Prompt ID: 61310f44-27de-4dfd-9a5d-a00f128b3cae
2026-01-31 03:43:14 [INFO] Generating new code...
2026-01-31 03:43:14 [INFO] Using Prompt: <tables>

<table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


</tables>

The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>



Update this initial code:
```python
# TODO: import the required dependencies
import pandas as pd

# Write code here

# Declare result var: 
type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }

```



### QUERY
 "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"

At the end, declare "result" variable as a dictionary of type and value in the following format:

type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }



Generate python code and return full updated code:

### Note: Use only relevant table for query and do aggregation, sorting, joins and grouby through sql query
2026-01-31 03:44:46 [INFO] Code Generated:
# TODO: import the required dependencies
import pandas as pd

# Write code here

def execute_sql_query(sql_query: str) -> pd.DataFrame:
    """This method connects to the database, executes the sql query and returns the dataframe"""
    # Assuming this function is already defined and works with your environment.
    pass

# Execute SQL Query to calculate average Cargo Weight for vehicles with 'Diesel' Fuel Type
sql_query = """
SELECT AVG(Cargo Weight (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
"""

# Execute the query and get the result
result_df = execute_sql_query(sql_query)

# Extract the average cargo weight from the dataframe
average_cargo_weight = result_df.iloc[0]['AverageCargoWeight']

# Declare result var:
result = { "type": "number", "value": average_cargo_weight }
2026-01-31 03:44:46 [INFO] Validating code requirements...
2026-01-31 03:44:46 [INFO] Code validation successful.
2026-01-31 03:44:46 [INFO] Cleaning the generated code...
2026-01-31 03:44:46 [INFO] An error occurred during code generation: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
2026-01-31 03:44:46 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';

2026-01-31 03:44:46 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';

2026-01-31 03:44:46 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"

You generated the following Python code:
# TODO: import the required dependencies
import pandas as pd

# Write code here

def execute_sql_query(sql_query: str) -> pd.DataFrame:
    """This method connects to the database, executes the sql query and returns the dataframe"""
    # Assuming this function is already defined and works with your environment.
    pass

# Execute SQL Query to calculate average Cargo Weight for vehicles with 'Diesel' Fuel Type
sql_query = """
SELECT AVG(Cargo Weight (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
"""

# Execute the query and get the result
result_df = execute_sql_query(sql_query)

# Extract the average cargo weight from the dataframe
average_cargo_weight = result_df.iloc[0]['AverageCargoWeight']

# Declare result var:
result = { "type": "number", "value": average_cargo_weight }

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:45:37 [INFO] Code Generated:
# TODO: import the required dependencies
import pandas as pd

def execute_sql_query(sql_query: str) -> pd.DataFrame:
    """This method connects to the database, executes the sql query and returns the dataframe"""
    # Assuming this function is defined elsewhere in your codebase that handles the connection and execution part.
    return pd.read_sql_query(sql_query, 'your_database_connection')

# Define the SQL query to calculate the average Cargo Weight for all vehicles with 'Diesel' Fuel Type
sql_query = """
SELECT AVG(Cargo Weight (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
"""

# Execute the SQL query and get the result dataframe
result_df = execute_sql_query(sql_query)

# Convert the result to a number (average cargo weight)
average_cargo_weight = result_df.iloc[0]['AverageCargoWeight']

# Declare result var: 
result = {
    "type": "number",
    "value": average_cargo_weight
}
2026-01-31 03:45:37 [INFO] Validating code requirements...
2026-01-31 03:45:37 [INFO] Code validation successful.
2026-01-31 03:45:37 [INFO] Cleaning the generated code...
2026-01-31 03:45:37 [INFO] An error occurred during code generation: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
2026-01-31 03:45:37 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';

2026-01-31 03:45:37 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';

2026-01-31 03:45:37 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"

You generated the following Python code:
# TODO: import the required dependencies
import pandas as pd

def execute_sql_query(sql_query: str) -> pd.DataFrame:
    """This method connects to the database, executes the sql query and returns the dataframe"""
    # Assuming this function is defined elsewhere in your codebase that handles the connection and execution part.
    return pd.read_sql_query(sql_query, 'your_database_connection')

# Define the SQL query to calculate the average Cargo Weight for all vehicles with 'Diesel' Fuel Type
sql_query = """
SELECT AVG(Cargo Weight (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
"""

# Execute the SQL query and get the result dataframe
result_df = execute_sql_query(sql_query)

# Convert the result to a number (average cargo weight)
average_cargo_weight = result_df.iloc[0]['AverageCargoWeight']

# Declare result var: 
result = {
    "type": "number",
    "value": average_cargo_weight
}

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) as AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:46:12 [INFO] Question: "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"
2026-01-31 03:46:12 [INFO] Running PandasAI with litellm LLM...
2026-01-31 03:46:12 [INFO] Prompt ID: ad3dcbc1-7617-41be-828c-7b3e0b8bf3a3
2026-01-31 03:46:12 [INFO] Generating new code...
2026-01-31 03:46:12 [INFO] Using Prompt: <tables>

<table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


</tables>

The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>



Update this initial code:
```python
# TODO: import the required dependencies
import pandas as pd

# Write code here

# Declare result var: 
type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }

```



### QUERY
 "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"

At the end, declare "result" variable as a dictionary of type and value in the following format:

type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }



Generate python code and return full updated code:

### Note: Use only relevant table for query and do aggregation, sorting, joins and grouby through sql query
2026-01-31 03:46:21 [INFO] Code Generated:
# TODO: import the required dependencies
import pandas as pd

def execute_sql_query(sql_query: str) -> pd.DataFrame:
    """This method connects to the database, executes the sql query and returns the dataframe"""
    # Assuming this function is correctly implemented elsewhere in your codebase
    pass

# Write code here

# SQL Query to calculate the average Cargo Weight for all vehicles with 'Diesel' Fuel Type
sql_query = """
SELECT AVG(Cargo Weight (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
"""

# Execute the query
result_df = execute_sql_query(sql_query)

# Convert the result to a number (since we are calculating an average, it will be a single value)
average_cargo_weight = result_df.iloc[0]['AverageCargoWeight']

# Declare result var:
result = { "type": "number", "value": average_cargo_weight }
2026-01-31 03:46:21 [INFO] Validating code requirements...
2026-01-31 03:46:21 [INFO] Code validation successful.
2026-01-31 03:46:21 [INFO] Cleaning the generated code...
2026-01-31 03:46:21 [INFO] An error occurred during code generation: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
2026-01-31 03:46:21 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';

2026-01-31 03:46:21 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';

2026-01-31 03:46:21 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"

You generated the following Python code:
# TODO: import the required dependencies
import pandas as pd

def execute_sql_query(sql_query: str) -> pd.DataFrame:
    """This method connects to the database, executes the sql query and returns the dataframe"""
    # Assuming this function is correctly implemented elsewhere in your codebase
    pass

# Write code here

# SQL Query to calculate the average Cargo Weight for all vehicles with 'Diesel' Fuel Type
sql_query = """
SELECT AVG(Cargo Weight (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
"""

# Execute the query
result_df = execute_sql_query(sql_query)

# Convert the result to a number (since we are calculating an average, it will be a single value)
average_cargo_weight = result_df.iloc[0]['AverageCargoWeight']

# Declare result var:
result = { "type": "number", "value": average_cargo_weight }

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:47:05 [INFO] Code Generated:
# TODO: import the required dependencies
import pandas as pd

def execute_sql_query(sql_query: str) -> pd.DataFrame:
    """This method connects to the database, executes the sql query and returns the dataframe"""
    # Assuming this function is already defined elsewhere in your codebase.
    pass

# Write SQL query to calculate the average Cargo Weight for all vehicles with 'Diesel' Fuel Type
sql_query = """
SELECT AVG(Cargo Weight (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
"""

# Execute the SQL query
result_df = execute_sql_query(sql_query)

# Convert the result to a number (the average Cargo Weight)
average_cargo_weight = result_df.iloc[0]['AverageCargoWeight']

# Declare result var:
result = {
    "type": "number",
    "value": average_cargo_weight
}
2026-01-31 03:47:05 [INFO] Validating code requirements...
2026-01-31 03:47:05 [INFO] Code validation successful.
2026-01-31 03:47:05 [INFO] Cleaning the generated code...
2026-01-31 03:47:05 [INFO] An error occurred during code generation: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
2026-01-31 03:47:05 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';

2026-01-31 03:47:05 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';

2026-01-31 03:47:05 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 "What is the average Cargo Weight for all vehicles with 'Diesel' Fuel Type?"

You generated the following Python code:
# TODO: import the required dependencies
import pandas as pd

def execute_sql_query(sql_query: str) -> pd.DataFrame:
    """This method connects to the database, executes the sql query and returns the dataframe"""
    # Assuming this function is already defined elsewhere in your codebase.
    pass

# Write SQL query to calculate the average Cargo Weight for all vehicles with 'Diesel' Fuel Type
sql_query = """
SELECT AVG(Cargo Weight (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';
"""

# Execute the SQL query
result_df = execute_sql_query(sql_query)

# Convert the result to a number (the average Cargo Weight)
average_cargo_weight = result_df.iloc[0]['AverageCargoWeight']

# Declare result var:
result = {
    "type": "number",
    "value": average_cargo_weight
}

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 39, in generate_code
    cleaned_code = self.validate_and_clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 63, in validate_and_clean_code
    return self._code_cleaner.clean_code(code)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 164, in clean_code
    node = self._validate_and_make_table_name_case_sensitive(node)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 86, in _validate_and_make_table_name_case_sensitive
    sql_query = self._clean_sql_query(node.value.value)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\code_cleaning.py", line 68, in _clean_sql_query
    table_names = SQLParser.extract_table_names(sql_query, dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\query_builders\sql_parser.py", line 78, in extract_table_names
    parsed = sqlglot.parse(sql_query, dialect=dialect)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\dialects\dialect.py", line 931, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1432, in parse
    return self._parse(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1501, in _parse
    expressions.append(parse_method(self))
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1742, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 3027, in _parse_select
    projections = self._parse_projections()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 2967, in _parse_projections
    return self._parse_expressions()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6727, in _parse_expressions
    return self._parse_csv(self._parse_expression)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6681, in _parse_csv
    parse_result = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4452, in _parse_expression
    return self._parse_alias(self._parse_assignment())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4455, in _parse_assignment
    this = self._parse_disjunction()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4476, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4479, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4482, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4485, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4488, in _parse_range
    this = this or self._parse_bitwise()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4644, in _parse_bitwise
    this = self._parse_term()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4678, in _parse_term
    this = self._parse_factor()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4701, in _parse_factor
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4721, in _parse_exponent
    return self._parse_tokens(self._parse_unary, self.EXPONENT)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 6695, in _parse_tokens
    this = parse_method()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4726, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 4778, in _parse_type
    this = self._parse_column()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5061, in _parse_column
    this = self._parse_column_reference()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5070, in _parse_column_reference
    this = self._parse_field()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5265, in _parse_field
    field = self._parse_primary() or self._parse_function(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5288, in _parse_function
    func = self._parse_function_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 5378, in _parse_function_call
    self._match_r_paren(this)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 7316, in _match_r_paren
    self.raise_error("Expecting )")
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\sqlglot\parser.py", line 1545, in raise_error
    raise error
sqlglot.errors.ParseError: Expecting ). Line 2, Col: 23.
  
SELECT AVG(Cargo [4mWeight[0m (kg)) AS AverageCargoWeight
FROM table_c60b5924d5d5b1bc81a05a2bebf27a08
WHERE Fuel Type = 'Diesel';


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:50:46 [INFO] Question: Calculate the Total Monthly CO2 Emissions for each company. Show the list.
2026-01-31 03:50:46 [INFO] Running PandasAI with litellm LLM...
2026-01-31 03:50:46 [INFO] Prompt ID: a2f15e30-bb03-4e92-9b41-85a9cd166ac6
2026-01-31 03:50:46 [INFO] Generating new code...
2026-01-31 03:50:46 [INFO] Using Prompt: <tables>

<table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


</tables>

The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>



Update this initial code:
```python
# TODO: import the required dependencies
import pandas as pd

# Write code here

# Declare result var: 
type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }

```



### QUERY
 Calculate the Total Monthly CO2 Emissions for each company. Show the list.

At the end, declare "result" variable as a dictionary of type and value in the following format:

type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }



Generate python code and return full updated code:

### Note: Use only relevant table for query and do aggregation, sorting, joins and grouby through sql query
2026-01-31 03:50:50 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
2026-01-31 03:50:50 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:50:50 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:50:51 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 Calculate the Total Monthly CO2 Emissions for each company. Show the list.

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:50:51 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
2026-01-31 03:50:51 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:50:51 [INFO] Retrying Code Generation (1/3)...
2026-01-31 03:50:51 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:50:51 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 Calculate the Total Monthly CO2 Emissions for each company. Show the list.

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:50:51 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
2026-01-31 03:50:51 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:50:51 [INFO] Retrying Code Generation (2/3)...
2026-01-31 03:50:51 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:50:51 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 Calculate the Total Monthly CO2 Emissions for each company. Show the list.

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:50:51 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
2026-01-31 03:50:51 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:50:51 [INFO] Retrying Code Generation (3/3)...
2026-01-31 03:50:51 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:50:51 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 Calculate the Total Monthly CO2 Emissions for each company. Show the list.

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:50:51 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
2026-01-31 03:50:51 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:50:51 [INFO] Maximum retry attempts exceeded. Last error: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
2026-01-31 03:59:18 [INFO] Question: Calculate CO2 Costs
2026-01-31 03:59:18 [INFO] Running PandasAI with litellm LLM...
2026-01-31 03:59:18 [INFO] Prompt ID: 476eb193-5deb-4786-9880-fb108f7d8415
2026-01-31 03:59:18 [INFO] Generating new code...
2026-01-31 03:59:18 [INFO] Using Prompt: <tables>

<table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


</tables>

The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>



Update this initial code:
```python
# TODO: import the required dependencies
import pandas as pd

# Write code here

# Declare result var: 
type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }

```



### QUERY
 Calculate CO2 Costs

At the end, declare "result" variable as a dictionary of type and value in the following format:

type (possible values "string", "number", "dataframe", "plot"). Examples: { "type": "string", "value": f"The highest salary is {highest_salary}." } or { "type": "number", "value": 125 } or { "type": "dataframe", "value": pd.DataFrame({...}) } or { "type": "plot", "value": "temp_chart.png" }



Generate python code and return full updated code:

### Note: Use only relevant table for query and do aggregation, sorting, joins and grouby through sql query
2026-01-31 03:59:22 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
2026-01-31 03:59:22 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:59:22 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:59:22 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 Calculate CO2 Costs

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:59:22 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
2026-01-31 03:59:22 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:59:22 [INFO] Retrying Code Generation (1/3)...
2026-01-31 03:59:22 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:59:22 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 Calculate CO2 Costs

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:59:22 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
2026-01-31 03:59:22 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:59:22 [INFO] Retrying Code Generation (2/3)...
2026-01-31 03:59:22 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:59:22 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 Calculate CO2 Costs

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:59:22 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
2026-01-31 03:59:22 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:59:22 [INFO] Retrying Code Generation (3/3)...
2026-01-31 03:59:22 [INFO] Execution failed with error: Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:59:22 [INFO] Using Prompt: <table dialect="duckdb" table_name="table_c60b5924d5d5b1bc81a05a2bebf27a08" columns="[{"name": "Company", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Vehicle Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Fuel Type", "type": "string", "description": null, "expression": null, "alias": null}, {"name": "Trips per Month", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Average Distance (km)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "Cargo Weight (kg)", "type": "integer", "description": null, "expression": null, "alias": null}, {"name": "CO2 Emission per Trip (kg)", "type": "integer", "description": null, "expression": null, "alias": null}]" dimensions="7x7">
Company,Vehicle Type,Fuel Type,Trips per Month,Average Distance (km),Cargo Weight (kg),CO2 Emission per Trip (kg)
Alpha Logistics,Truck,Diesel,120,150,5000,75
Beta Couriers,Van,Gasoline,300,50,1000,15
Gamma Shipping,Truck,Electric,80,200,7000,0
Delta Transport,Van,Diesel,200,60,1200,18
Epsilon Movers,Truck,Diesel,100,180,6000,90
</table>


The following functions have already been provided. Please use them as needed and do not redefine them.
<function>
def execute_sql_query(sql_query: str) -> pd.DataFrame
    """This method connects to the database, executes the sql query and returns the dataframe"""
</function>


The user asked the following question:
### QUERY
 Calculate CO2 Costs

You generated the following Python code:
None

However, it resulted in the following error:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}


Fix the python code above and return the new python code but the code generated should use execute_sql_query function
2026-01-31 03:59:22 [INFO] An error occurred during code generation: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
2026-01-31 03:59:22 [INFO] Stack Trace:
Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 176, in generate_code_with_retries
    return self.generate_code(query)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\agent\base.py", line 119, in generate_code
    code = self._code_generator.generate_code(prompt)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 52, in generate_code
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 221, in _make_common_sync_call
    response = sync_httpx_client.post(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 1010, in post
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\http_handler.py", line 992, in post
    response.raise_for_status()
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 3798, in completion
    response = base_llm_http_handler.completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 524, in completion
    response = self._make_common_sync_call(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 246, in _make_common_sync_call
    raise self._handle_error(e=e, provider_config=provider_config)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\llms\custom_httpx\llm_http_handler.py", line 4505, in _handle_error
    raise provider_config.get_error_class(
litellm.llms.ollama.common_utils.OllamaError: {"error":"model 'qwen2.5:1.5b' not found"}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\core\code_generation\base.py", line 33, in generate_code
    code = self._context.config.llm.generate_code(prompt, self._context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai\llm\base.py", line 173, in generate_code
    response = self.call(instruction, context)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\pandasai_litellm\litellm.py", line 68, in call
    completion(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1740, in wrapper
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\utils.py", line 1561, in wrapper
    result = original_function(*args, **kwargs)
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\main.py", line 4230, in completion
    raise exception_type(
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2378, in exception_type
    raise e
  File "C:\Users\S Divya\AppData\Roaming\Python\Python310\site-packages\litellm\litellm_core_utils\exception_mapping_utils.py", line 2347, in exception_type
    raise APIConnectionError(
litellm.exceptions.APIConnectionError: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}

2026-01-31 03:59:22 [INFO] Maximum retry attempts exceeded. Last error: litellm.APIConnectionError: OllamaException - {"error":"model 'qwen2.5:1.5b' not found"}
